# Changelog

## [1.7.0] - 2026-02-16

### ✨ 功能更新
- **Quick Ask 三模式完善**：支持 Ask（对话）、Edit（Diff/Apply 修改）、Direct（直改写入）三种工作流。
- **预览能力增强**：预览视图可自定义；Direct 模式支持“写入前预览确认”可选。
- **设置能力增强**：设置界面支持自定义快捷键；自定义按键功能优化；ESC 阻断与命令更新。
- **模型选择增强**：模型/供应商配置体验优化，支持自动检索可用模型与供应商。
- **主题适配**：适配深色模式；兼容子插件主题。
- **触发器规则可配置**：支持启用/关闭文本触发器系统，并可自定义触发规则（字符串/正则）以唤出对话弹层。
- **@ / # 快捷系统**：`@` 选择上下文文件/文件夹；`#` 快速检索并插入常用提示词。

### 🪟 变更对比视窗（Apply / Diff）
- **视图模式可选**：Fast Draft / Precise Review / Balanced Focus 三种呈现方式，适配不同审阅习惯。
- **视觉细节可调**：已处理状态标记、已处理内容弱化透明度、自动折叠已处理块，减少滚动干扰。
- **操作栏布局可配**：支持操作栏位置（顶部/底部）、吸附固定、对齐方式等配置。
- **交互行为更可控**：支持决策后自动跳转及延迟、强制完全决策后才可应用、未决策内容的默认处理策略（默认全部接受/默认保留原文）。
- **Apply 视图优化**：Apply 视图与 UI 持续优化，减少干扰并提升审阅效率。

### 🧩 模型与供应商体验
- **模型列表自动获取**：支持从 API 拉取可用模型列表（OpenAI Compatible / Anthropic / Gemini / Ollama），降低手动维护成本。
- **Keychain 体验优化**：API Key 支持 keychain 保存/复用，获取模型列表时也沿用统一的密钥解析逻辑。

### 🎨 UI 与体验更新
- **设置流程优化**：设置页操作流程与文案优化，模块化结构更清晰。
- **弹窗与编辑体验优化**：思考中/选中内容/长文本等交互与展示持续优化。
- **界面清理**：移除多余的上下文列表区域，界面更聚焦。
- **文案与清理体验**：优化内容清理与提示文案（will be cleanly removed, keeping your text clean.）。
- **主题适配增强**：完善暗色主题与高对比度模式下的显示效果。

### 🐛 Bug 修复
- **# 提示词触发修复**：修复 `#` 无法唤出提示词选择等相关问题。
- **弹窗稳定性修复**：修复思考时弹窗异常关闭、弹窗位置异常等问题。
- **设置页问题修复**：修复设置界面显示异常、快捷键设置等相关问题。
- **工具栏修复**：修复 selecttoolbar 相关问题。
- **清理修复**：清理多余文件并修复 `#` 键相关问题。

## [1.6.1] - 2026-02-15

### 🧱 代码重构
- **Popup / 触发层重构**：重构 `src/ui/at-trigger-popup.ts`，并抽离 `InputContextSelector`（@ 上下文选择）与 `PromptSelectorPopup`（# 提示词选择），统一事件监听/关闭逻辑，降低耦合。
- **Settings 系统重构**：引入 `SettingsManager` 分离数据与 UI；设置页拆分为 `settings-tab` + `views/*` 的模块化结构，便于扩展与维护（含补全快捷键录制与 keymap 刷新）。

### ⚙️ 设置与快捷键
- **设置界面模块化**：配置项按功能拆分，查找与调整更直观。
- **对话/补全快捷键可配置**：对话命令可在 Obsidian「设置 → 快捷键」中自定义；Tab 补全支持在设置中录制/修改按键。

### 🪟 弹窗与交互优化
- **拖动逻辑优化**：修复拖动过程中弹窗位置“乱跳”的问题，交互更稳定。

### 🎛️ 模式调整
- **Ask / Edit / Direct 模式分离**：三种模式职责更清晰——Ask 用于对话问答；Edit 走 Diff/Apply 确认修改；Direct 直接将修改应用到文档。

### 🐛 Bug 修复
- **@ 与 # 触发修复**：修复上下文选择与提示词选择的相关异常。

## [1.6.0] - 2026-02-05

### 🚀 重大更新
- **Tab 自动补全功能**：全新的即时代码/文本补全体验，智能预测您的输入，提升写作效率。
- **选中文字唤出工具栏**：选中编辑器中的文字即可唤出快捷工具栏，常用操作触手可及。

### ✨ 功能更新
- **Keychain 存储 API**：新增 API 支持安全存储敏感信息（如 API Keys），提升安全性。
- **Diff 界面**：全新的差异对比界面，变更内容一目了然，方便审阅 AI 生成的内容。

### 🎨 界面与体验更新
- **AI 对话弹窗优化**：
    - 支持无级调节大小，适应不同屏幕和工作流。
    - 底部功能栏布局优化，操作更顺手。
    - 整体 UI 风格优化，更加精致现代。
- **设置界面**：排版重新设计，配置项更加直观易懂。
