# MarkdownNext AI

MarkdownNext AI 是一个功能强大的 Obsidian 插件，旨在通过 AI 技术增强您的写作体验。它集成了智能续写、多模态（图片）理解以及强大的上下文感知功能，让您的笔记工作流更加流畅和智能化。

## ✨ 主要功能

*   **🤖 多模型支持**: 支持 OpenAI 兼容的 API 接口，预设GPT-5, Gemini 3 等多种模型配置。
*   **📝 智能续写**: 根据当前光标位置的上下文，智能生成后续内容。
*   **🎯 上下文引用**: 通过 `@` 符号快速引用库中的其他文件或文件夹作为 AI 的参考上下文。
*   **🖼️ 多模态交互**: 支持在对话框中直接粘贴图片或上传图片，利用视觉模型进行分析和描述。

## ✨ 新增特性与改进

### 🛠️ 功能增强
*   **智能动态布局**: `@` 唤起的输入框现已支持**自适应宽度**。输入内容越多，窗口自动展宽，为您提供更开阔的编辑视野，同时模型选择框也会根据选项长度自动调整。
*   **精准滚动跟随**: 重构了弹窗定位逻辑，现在 AI 窗口会**完美附着于编辑器滚动层**。无论您如何滚动长文档，弹窗始终稳定跟随光标，彻底解决了错位问题。
*   **经典选择器回归**: 重新实现了文件与文件夹选择器，采用经典的**复选框多选模式**，支持搜索过滤，让上下文引用的选择更加高效直观。
*   **配置智能清洗**: 增强了设置系统的健壮性，自动识别并过滤无效或损坏的模型配置数据，防止设置页面污染。

### 🎨 界面优化
*   对整体 UI 进行了细节打磨，包括按钮状态样式的持久化、下拉菜单的视觉优化等，提供更精致的交互体验。

## 🚀 安装指南

由于本插件尚未上架 Obsidian 社区插件市场，您需要手动安装。

1.  下载本仓库的最新 Release 版本（或下载源码）。
2.  打开您的 Obsidian 仓库文件夹，进入 `.obsidian/plugins` 目录。
3.  创建一个名为 `markdown-next-ai` 的新文件夹。
4.  将 `main.js`, `manifest.json`, `styles.css` 三个文件复制到该文件夹中。
5.  重启 Obsidian。
6.  在 **设置** -> **第三方插件** 中找到 "MarkdownNext AI" 并启用它。

## ⚙️ 配置说明

启用插件后，请进入插件设置页面进行配置：

1.  **API 设置**:
    *   **API Key**: 输入您的 OpenAI API Key 或兼容服务的 Key。
    *   **Base URL**: 默认为 `https://api.openai.com/v1`，如果您使用中转服务或自定义模型服务（如 OneAPI），请修改此地址。
2.  **模型管理**:
    *   您可以启用/禁用特定模型，或添加自定义模型配置。
    *   支持设置模型的类型（文本、视觉、思考）。

## 📖 使用指南

###  输入模式 (@ 触发)
在编辑器中输入 `@` 符号，将唤起增强输入框：
*   **输入提示词**: 直接输入您想要 AI 执行的指令。
*   **引用上下文**: 继续输入文件名，选择库中的笔记作为参考资料。
*   **图片处理**:
    *   直接 **粘贴 (Ctrl/Cmd + V)** 剪贴板中的图片。
    *   点击上传按钮选择本地图片。
*   **切换模型**: 在弹窗底部快速切换当前使用的 AI 模型。

## 🛠️ 开发与构建

本项目为纯 JavaScript 开发，无需复杂的编译流程。

*   **main.js**: 核心逻辑文件。
*   **styles.css**: 样式文件。
*   **manifest.json**: 插件元数据。

如果您想修改代码，直接编辑 `main.js` 后在 Obsidian 中使用 "Reload Custom Plugins" 命令重载即可生效。

## ⚠️ 注意事项

*   请妥善保管您的 API Key，不要将其分享给他人。
*   本插件会将您的笔记内容发送至配置的 AI 服务商，请确保您了解并接受相关的隐私政策。

## License

MIT
