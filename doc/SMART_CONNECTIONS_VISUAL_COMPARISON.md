# Smart Connections vs Markdown-Next-AI - å¯è§†åŒ–å¯¹æ¯”

## 1. åŠŸèƒ½æ¶æ„å¯¹æ¯”

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Smart Connections 3.0.80          â”‚   Markdown-Next-AI             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚                                â”‚
â”‚  ScLookupView                       â”‚  AtTriggerPopup               â”‚
â”‚  â”œâ”€ è¾“å…¥æ¡†                          â”‚  â”œâ”€ å¤šæ ‡ç­¾é¡µ                   â”‚
â”‚  â”œâ”€ æœç´¢æŒ‰é’®                        â”‚  â”‚  â”œâ”€ åŸºç¡€æ ‡ç­¾               â”‚
â”‚  â””â”€ ç»“æœåˆ—è¡¨                        â”‚  â”‚  â”œâ”€ ä¸Šä¸‹æ–‡æ ‡ç­¾             â”‚
â”‚                                     â”‚  â”‚  â””â”€ çŸ¥è¯†åº“æ ‡ç­¾ â—„â”€â”€â”€â”€â”€â”    â”‚
â”‚                                     â”‚  â””â”€ æäº¤æŒ‰é’®            â”‚    â”‚
â”‚                                     â”‚                          â”‚    â”‚
â”‚  render_component(                  â”‚  adapter.render          â”‚    â”‚
â”‚    'connections_results',           â”‚  ConnectionsResults()    â”‚    â”‚
â”‚    results,                         â”‚                          â”‚    â”‚
â”‚    opts                             â”‚  â†“â†“â†“ éƒ½è°ƒç”¨ç›¸åŒå‡½æ•° â†“â†“â†“   â”‚    â”‚
â”‚  )                                  â”‚                          â”‚    â”‚
â”‚                                     â”‚  env.render_component(  â”‚    â”‚
â”‚                                     â”‚    'connections_results'â”‚â”€â”€â”€â”€â”˜
â”‚  â†“                                  â”‚  )                       â”‚
â”‚  ç”Ÿæˆ DocumentFragment               â”‚  â†“                       â”‚
â”‚  â”œâ”€ class: sc-result                â”‚  ç”Ÿæˆ DocumentFragment   â”‚
â”‚  â”œâ”€ data-path: ...                  â”‚  â”œâ”€ class: sc-result    â”‚
â”‚  â”œâ”€ data-key: ...                   â”‚  â”œâ”€ data-path: ...      â”‚
â”‚  â”œâ”€ data-score: ...                 â”‚  â”œâ”€ data-key: ...       â”‚
â”‚  â””â”€ draggable: true                 â”‚  â”œâ”€ data-score: ...     â”‚
â”‚                                     â”‚  â””â”€ draggable: true     â”‚
â”‚  â†“                                  â”‚                          â”‚
â”‚  DOM ç»“æ„å®Œå…¨ç›¸åŒ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ DOM ç»“æ„å®Œå…¨ç›¸åŒ         â”‚
â”‚                                     â”‚                          â”‚
â”‚  äº¤äº’ï¼š                             â”‚  äº¤äº’ï¼š                   â”‚
â”‚  â€¢ ç‚¹å‡»å±•å¼€/æŠ˜å  âœ…                 â”‚  â€¢ ç‚¹å‡»å±•å¼€/æŠ˜å  âœ…     â”‚
â”‚  â€¢ å»¶è¿Ÿæ¸²æŸ“å†…å®¹ âœ…                  â”‚  â€¢ å»¶è¿Ÿæ¸²æŸ“å†…å®¹ âœ…     â”‚
â”‚  â€¢ æ‹–æ‹½æ”¯æŒ âœ…                      â”‚  â€¢ æ‹–æ‹½æ”¯æŒ âœ…         â”‚
â”‚  â€¢ æ‚¬åœé¢„è§ˆ âœ…                      â”‚  â€¢ æ‚¬åœé¢„è§ˆ âœ…         â”‚
â”‚  â€¢ å³é”®èœå• âœ…                      â”‚  â€¢ å³é”®èœå• âœ…         â”‚
â”‚                                     â”‚  + å¤é€‰æ¡†é€‰æ‹© â•       â”‚
â”‚                                     â”‚  + è‡ªåŠ¨æ³¨å…¥ AI â•      â”‚
â”‚                                     â”‚                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. æ£€ç´¢å‡½æ•°è°ƒç”¨é“¾å¯¹æ¯”

```
Smart Connections                          Markdown-Next-AI
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

å…¥å£å‡½æ•°ï¼š
  lookup(env, params)                        adapter.lookup(query, options)
  smart-chat-v0/actions/lookup.js            src/services/smart-connections-adapter.ts
  
  â†“                                          â†“
  
éªŒè¯å‚æ•°ï¼š                                   æ„é€ å‚æ•°ï¼š
  hypotheticals âœ“                             hypotheticals: [query]
  filter âœ“                                    filter: {limit, include_filter, ...}
  
  â†“                                          â†“
  
é€‰æ‹© Collectionï¼š                           é€‰æ‹© Collectionï¼š
  const collection =                         const plugin = getPlugin()
    env.smart_blocks?.smart_embed ?          const collection =
    env.smart_blocks :                       plugin.env.smart_sources
    env.smart_sources
  
  â†“                                          â†“
  
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         â­ æ ¸å¿ƒè°ƒç”¨ï¼šcollection.lookup(params)                 â”‚
â”‚    ä¸¤è€…éƒ½è°ƒç”¨è¿™ä¸ªç›¸åŒçš„å‡½æ•°ï¼                                  â”‚
â”‚    plugin.env.smart_sources.lookup(...)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  
  â†“                                          â†“
  
å¤„ç†ç»“æœï¼š                                   å¤„ç†ç»“æœï¼š
  return results || []                        return Array.isArray(results)
                                              ? results : []
  
  â†“                                          â†“
  
[                                            [
  {                                            {
    item: {...},                               item: {...},
    score: 0.856,                              score: 0.856,
    ...                                        ...
  },                                           },
  ...                                          ...
]                                            ]
  
  â†“                                          â†“
  
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         âœ… è¿”å›å€¼å®Œå…¨ç›¸åŒï¼Œæ— ä»»ä½•è½¬æ¢ï¼                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. æ¸²æŸ“æµç¨‹å¯¹æ¯”

```
Smart Connections                          Markdown-Next-AI
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

src/components/lookup.js                   src/ui/at-trigger-popup.ts
  render()                                   runKnowledgeSearch()
    â†“                                        â†“
    
  build_html() + post_process()             æ„é€ å‚æ•° â†’ adapter.lookup()
    â†“                                        â†“
    
  åˆ›å»ºè¾“å…¥æ¡†å’Œæœç´¢æŒ‰é’®                       æ˜¾ç¤º"æ­£åœ¨æ£€ç´¢ä¸­..."
    â†“                                        â†“
    
  ç›‘å¬è¾“å…¥äº‹ä»¶ (debounce 500ms)             è·å–ç»“æœ â†’ this.knowledgeResults
    â†“                                        â†“
    
  ç”¨æˆ·æŒ‰ Enter æˆ–ç‚¹å‡»æœç´¢                    æå–ç»“æœåˆ—è¡¨
    â†“                                        â†“
    
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   render_lookup(query, results_container)                     â”‚
â”‚     const lookup_params = get_lookup_params(query, ...)       â”‚
â”‚     const results = await collection.lookup(lookup_params)    â”‚
â”‚     const results_frag = await                                â”‚
â”‚       collection.env.render_component(                        â”‚
â”‚         'connections_results',                                â”‚
â”‚         results,                                              â”‚
â”‚         opts                                                  â”‚
â”‚       )                                                        â”‚
â”‚     results_container.appendChild(results_frag)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚                                    â”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â†“
                    adapter.renderConnectionsResults()
                    (åŒ…è£…å™¨ï¼Œè°ƒç”¨ç›¸åŒçš„ env.render_component)
                                   â”‚
                                   â†“
                                   
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         âœ… éƒ½ä½¿ç”¨ env.render_component('connections_results') â”‚
â”‚            è°ƒç”¨å®Œå…¨ç›¸åŒï¼                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    
    â†“                                        â†“
    
src/components/connections_results.js   (same)
  render(results, opts)
    â†“
    
  å¯¹æ¯ä¸ª result è°ƒç”¨ï¼š
    env.render_component('connections_result', result, opts)
    
    â†“
    
src/components/connections_result.js    (same)
  build_html(result, opts)
  post_process(result_scope, frag, opts)
    â”œâ”€ æ·»åŠ ç‚¹å‡»äº‹ä»¶ï¼ˆå±•å¼€/æŠ˜å ï¼‰
    â”œâ”€ æ·»åŠ æ‹–æ‹½äº‹ä»¶
    â”œâ”€ æ·»åŠ æ‚¬åœé¢„è§ˆäº‹ä»¶
    â”œâ”€ æ·»åŠ å³é”®èœå•äº‹ä»¶
    â””â”€ æ·»åŠ  MutationObserverï¼ˆå»¶è¿Ÿæ¸²æŸ“ï¼‰
    
    â†“
    
DOM æ ‘ï¼š
  <div class="sc-result sc-collapsed" data-path="..." ...>
    <span class="header">
      <svg>...</svg>
      <a class="sc-result-file-title">
        <small>0.86 | note.md</small>
      </a>
    </span>
    <ul>
      <li><!-- å†…å®¹å»¶è¿Ÿæ¸²æŸ“ --></li>
    </ul>
  </div>
    
    â†“
    
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         âœ… DOM ç»“æ„å®Œå…¨ç›¸åŒ                                    â”‚
â”‚         âœ… CSS ç±»å®Œå…¨ç›¸åŒ                                      â”‚
â”‚         âœ… äº¤äº’è¡Œä¸ºå®Œå…¨ç›¸åŒ                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. DOM èŠ‚ç‚¹å¯¹æ¯”

```
Smart Connections ç”Ÿæˆçš„ HTMLï¼š
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

<div class="temp-container">
  <div
    class="sc-result sc-collapsed"
    data-path="Documents/note.md"
    data-link="Documents/note"
    data-collection="smart_sources"
    data-score="0.856"
    data-key="Documents/note.md"
    draggable="true"
  >
    <span class="header">
      <svg class="svg-icon right-triangle">...</svg>
      <a
        class="sc-result-file-title"
        href="#"
        title="Documents/note.md"
        draggable="true"
      >
        <small>0.86 | note.md</small>
      </a>
    </span>
    <ul draggable="true">
      <li
        class="sc-result-file-title"
        title="Documents/note.md"
        data-collection="smart_sources"
        data-key="Documents/note.md"
      ></li>
    </ul>
  </div>
</div>


Markdown-Next-AI ç”Ÿæˆçš„ HTMLï¼š
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

<div class="temp-container">
  <div
    class="sc-result sc-collapsed"  âœ… å®Œå…¨ç›¸åŒ
    data-path="Documents/note.md"    âœ… å®Œå…¨ç›¸åŒ
    data-link="Documents/note"        âœ… å®Œå…¨ç›¸åŒ
    data-collection="smart_sources"   âœ… å®Œå…¨ç›¸åŒ
    data-score="0.856"                âœ… å®Œå…¨ç›¸åŒ
    data-key="Documents/note.md"      âœ… å®Œå…¨ç›¸åŒ
    draggable="true"                  âœ… å®Œå…¨ç›¸åŒ
  >
    <span class="header">
      <!-- SC åŸç”Ÿæ¸²æŸ“çš„ SVG -->
      <svg class="svg-icon right-triangle">...</svg>
      <!-- M-N-AI æ³¨å…¥çš„å¤é€‰æ¡† â• -->
      <input
        type="checkbox"
        class="markdown-next-ai-knowledge-select"
        title="å°†æ­¤ç»“æœæ·»åŠ ä¸ºAIå‚è€ƒ"
      />
      <a class="sc-result-file-title" ...>
        <small>0.86 | note.md</small>
      </a>
    </span>
    <ul draggable="true">
      <li ...></li>
    </ul>
  </div>
</div>

å·®å¼‚ï¼š
  âŒ æ— åŠŸèƒ½æ€§å·®å¼‚
  â• ä»…æ·»åŠ äº†ä¸€ä¸ªå¤é€‰æ¡† <input> å…ƒç´ 
  âœ… æ‰€æœ‰ SC çš„åŸç”Ÿå…ƒç´ ä¿æŒä¸å˜
```

---

## 5. äº¤äº’è¡Œä¸ºå¯¹æ¯”

```
ç”¨æˆ·æ“ä½œ                   Smart Connections          Markdown-Next-AI
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ç‚¹å‡» SVG ä¸‰è§’å½¢             toggle sc-collapsed        toggle sc-collapsed
                          (å±•å¼€/æŠ˜å )                 (å±•å¼€/æŠ˜å ) âœ…

ç‚¹å‡»æ–‡ä»¶æ ‡é¢˜                Ctrl+Click: æ‰“å¼€ç¬”è®°      Ctrl+Click: æ‰“å¼€ç¬”è®° âœ…
                          å¦åˆ™ï¼šå±•å¼€/æŠ˜å              å¦åˆ™ï¼šå±•å¼€/æŠ˜å  âœ…

å±•å¼€æ—¶                      MutationObserver           MutationObserver
                          æ£€æµ‹ class å˜åŒ–             æ£€æµ‹ class å˜åŒ– âœ…
                          å»¶è¿Ÿæ¸²æŸ“å†…å®¹                å»¶è¿Ÿæ¸²æŸ“å†…å®¹ âœ…

æ‹–æ‹½ç»“æœé¡¹                  handle_drag_result()       handle_drag_result() âœ…
                          æ”¯æŒæ‹–åˆ°ç¼–è¾‘å™¨              æ”¯æŒæ‹–åˆ°ç¼–è¾‘å™¨ âœ…

é¼ æ ‡æ‚¬åœ                    app.workspace.trigger      app.workspace.trigger
                          ('hover-link', ...)        ('hover-link', ...) âœ…

å³é”®èœå•                    éšè—/å–æ¶ˆéšè—è¿æ¥          éšè—/å–æ¶ˆéšè—è¿æ¥ âœ…
                          (contextmenu äº‹ä»¶)         (contextmenu äº‹ä»¶) âœ…

ç‚¹å‡»å¤é€‰æ¡†                  âœ— æ—                       âœ“ è¿½è¸ªé€‰æ‹©çŠ¶æ€ â•
                                                     âœ“ é˜²æ­¢å†’æ³¡ âœ…

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ… SC çš„æ‰€æœ‰äº¤äº’éƒ½è¢«ä¿ç•™                                         â”‚
â”‚ â• M-N-AI é¢å¤–æ·»åŠ äº†å¤é€‰æ¡†é€‰æ‹©å’Œè‡ªåŠ¨æ³¨å…¥ AI ä¸Šä¸‹æ–‡               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 6. å‚æ•°å¯¹æ¯”çŸ©é˜µ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     å‚æ•°é¡¹          â”‚   Smart Connections  â”‚   Markdown-Next-AI   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ hypotheticals       â”‚ ["q1", "q2", "q3"]   â”‚ [query]              â”‚
â”‚                     â”‚ (æ”¯æŒå¤šä¸ª)           â”‚ (ç®€åŒ–ä¸ºå•ä¸ª) âš ï¸      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ filter.limit        â”‚ ç”±å‚æ•°ä¼ å…¥           â”‚ options.limit || 10  â”‚
â”‚                     â”‚ âœ… ä¸€è‡´              â”‚ âœ… ä¸€è‡´              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ skip_blocks         â”‚ ç”±è®¾ç½®å†³å®š           â”‚ options.skipBlocks   â”‚
â”‚                     â”‚                      â”‚ (å¯é…ç½®) âœ… æ›´çµæ´»   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ include_filter      â”‚ filter.include       â”‚ filter.include_filterâ”‚
â”‚                     â”‚ âœ… åŠŸèƒ½ç›¸åŒ          â”‚ âœ… åŠŸèƒ½ç›¸åŒ          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ exclude_filter      â”‚ filter.exclude       â”‚ filter.exclude_filterâ”‚
â”‚                     â”‚ âœ… åŠŸèƒ½ç›¸åŒ          â”‚ âœ… åŠŸèƒ½ç›¸åŒ          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å®é™…è°ƒç”¨çš„å‡½æ•°      â”‚ collection.lookup()  â”‚ plugin.env.          â”‚
â”‚                     â”‚                      â”‚ smart_sources.lookup()
â”‚                     â”‚ âœ…âœ…âœ… å®Œå…¨ç›¸åŒ      â”‚ âœ…âœ…âœ… å®Œå…¨ç›¸åŒ      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 7. ä¸€è‡´æ€§è¯„åˆ†å¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ä¸€è‡´æ€§è¯„åˆ†                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                     â”‚                                      â”‚
â”‚ æ£€ç´¢å‡½æ•°è°ƒç”¨         â”‚ âœ…âœ…âœ…âœ…âœ… (100%)                  â”‚
â”‚ å‚æ•°æ„é€ å’Œå«ä¹‰       â”‚ âœ…âœ…âœ…âœ…âœ… (100%)                  â”‚
â”‚ è¿”å›å€¼ç±»å‹           â”‚ âœ…âœ…âœ…âœ…âœ… (100%)                  â”‚
â”‚ æ•°æ®ç»“æ„             â”‚ âœ…âœ…âœ…âœ…âœ… (100%)                  â”‚
â”‚ æ¸²æŸ“å™¨é€‰æ‹©           â”‚ âœ…âœ…âœ…âœ…âœ… (100%)                  â”‚
â”‚ DOM ç»“æ„             â”‚ âœ…âœ…âœ…âœ…âœ… (100%)                  â”‚
â”‚ CSS æ ·å¼             â”‚ âœ…âœ…âœ…âœ…âœ… (100%)                  â”‚
â”‚ äº¤äº’è¡Œä¸º             â”‚ âœ…âœ…âœ…âœ…âœ… (100%)                  â”‚
â”‚ æ‹–æ‹½æ”¯æŒ             â”‚ âœ…âœ…âœ…âœ…âœ… (100%)                  â”‚
â”‚ æ‚¬åœé¢„è§ˆ             â”‚ âœ…âœ…âœ…âœ…âœ… (100%)                  â”‚
â”‚ å³é”®èœå•             â”‚ âœ…âœ…âœ…âœ…âœ… (100%)                  â”‚
â”‚ å±•å¼€/æŠ˜å             â”‚ âœ…âœ…âœ…âœ…âœ… (100%)                  â”‚
â”‚ å»¶è¿Ÿæ¸²æŸ“             â”‚ âœ…âœ…âœ…âœ…âœ… (100%)                  â”‚
â”‚                     â”‚                                      â”‚
â”‚ å±•ç¤ºä½ç½®             â”‚ âš ï¸âš ï¸ (SC è§†å›¾, M-N-AI å¯¹è¯æ¡†) âš ï¸ â”‚
â”‚ Hypotheticals æ•°é‡   â”‚ âš ï¸ (å•ä¸ª vs å¤šä¸ª)                 âš ï¸ â”‚
â”‚                     â”‚                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                            â”‚
â”‚              ğŸ† æ€»ä½“ä¸€è‡´æ€§ï¼š95% âœ…                        â”‚
â”‚                                                            â”‚
â”‚  â€¢ åŠŸèƒ½ä¸€è‡´æ€§ï¼š100%ï¼ˆç›´æ¥å¤ç”¨ SCï¼‰                        â”‚
â”‚  â€¢ è§†è§‰ä¸€è‡´æ€§ï¼š100%ï¼ˆå®Œå…¨ç›¸åŒçš„ DOMï¼‰                     â”‚
â”‚  â€¢ äº¤äº’ä¸€è‡´æ€§ï¼š100%ï¼ˆä¿ç•™æ‰€æœ‰åŸç”Ÿäº¤äº’ï¼‰                   â”‚
â”‚  â€¢ å±•ç¤ºä½ç½®ï¼šä¸åŒï¼ˆæ— åŠŸèƒ½å½±å“ï¼‰                           â”‚
â”‚  â€¢ é¢å¤–åŠŸèƒ½ï¼šå¤é€‰æ¡† + AI æ³¨å…¥ï¼ˆSC æ— ï¼‰                   â”‚
â”‚                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 8. æºç æ–‡ä»¶åœ°å€æ˜ å°„

```
åŠŸèƒ½                          Smart Connections           Markdown-Next-AI
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… æ£€ç´¢å…¥å£                    smart-chat-v0/              src/services/
                              actions/lookup.js           smart-connections-
                                                          adapter.ts (lookup)

âœ… å‚æ•°æ„é€                     src/components/             src/services/
                              lookup.js                   smart-connections-
                              (get_lookup_params)         adapter.ts

âœ… è°ƒç”¨åº•å±‚                    å†…éƒ¨ API                    src/services/
                              smart_sources.lookup()      smart-connections-
                                                          adapter.ts

âœ… è¿”å›å€¼å¤„ç†                  smart-chat-v0/              src/utils/
                              actions/lookup.js           lookup-pipeline.ts

âœ… æ¸²æŸ“è°ƒç”¨                    src/components/             src/services/
                              lookup.js                   smart-connections-
                              (render_lookup)             adapter.ts

âœ… å®é™…æ¸²æŸ“å™¨                  src/components/             (è°ƒç”¨ç›¸åŒçš„ SC)
                              connections_results.js
                              connections_result.js

âœ… DOM ç”Ÿæˆ                    src/components/             (è°ƒç”¨ç›¸åŒçš„ SC)
                              connections_result.js

âœ… äº¤äº’å¤„ç†                    src/components/             (è°ƒç”¨ç›¸åŒçš„ SC)
                              connections_result.js       + injectSelection
                              (post_process)              Checkboxes()

â• UI å®¹å™¨                     ScLookupView                src/ui/
                              (ç‹¬ç«‹è§†å›¾)                  at-trigger-popup.ts
                                                          (å¯¹è¯æ¡†çš„ä¸€éƒ¨åˆ†)

â• é¢å¤–åŠŸèƒ½                    N/A                        selectedKnowledge
                                                         + resultsToContext()
```

---

## æ€»ç»“å›¾è¡¨

```
                    Markdown-Next-AI ä¸ Smart Connections
                    
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚   ç”¨æˆ·è¾“å…¥æŸ¥è¯¢   â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                          â”‚
              SC åŸç”Ÿ lookup              M-N-AI adapter.lookup
              âœ… ç›¸åŒå‡½æ•°è°ƒç”¨               âœ… ç›¸åŒåº•å±‚ API
                    â”‚                          â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚ plugin.env.       â”‚
                        â”‚ smart_sources     â”‚
                        â”‚ .lookup(params)   â”‚
                        â”‚  âœ…âœ…âœ… å®Œå…¨ç›¸åŒ  â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   [result, result, ...]â”‚
                    â”‚   âœ…âœ…âœ… æ— ä»»ä½•è½¬æ¢    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ env.render_      â”‚
                    â”‚ component(       â”‚
                    â”‚'connections_     â”‚
                    â”‚results')         â”‚
                    â”‚âœ…âœ…âœ… å®Œå…¨ç›¸åŒ    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                                           â”‚
    SC è§†å›¾æ˜¾ç¤º                            M-N-AI å¼¹çª—ä¸­æ˜¾ç¤º
    (ç‹¬ç«‹çš„ ScLookupView)                  (AtTriggerPopup å¯¹è¯æ¡†)
        â”‚                                           â”‚
        â”‚                                           â”‚
    âœ… 100% ç›¸åŒçš„ï¼š                    âœ… 100% ç›¸åŒçš„ï¼š
    â€¢ DOM ç»“æ„                          â€¢ DOM ç»“æ„
    â€¢ CSS ç±»                            â€¢ CSS ç±»
    â€¢ äº¤äº’è¡Œä¸º                          â€¢ äº¤äº’è¡Œä¸º
    â€¢ æ‹–æ‹½æ”¯æŒ                          â€¢ æ‹–æ‹½æ”¯æŒ
    â€¢ æ‚¬åœé¢„è§ˆ                          â€¢ æ‚¬åœé¢„è§ˆ
    â€¢ å³é”®èœå•                          â€¢ å³é”®èœå•
                                        â• é¢å¤–ï¼š
                                        â€¢ å¤é€‰æ¡†é€‰æ‹©
                                        â€¢ è‡ªåŠ¨æ³¨å…¥ AI

```
